2025-06-16 15:05:09,193 [INFO] Using device: cpu
2025-06-16 15:05:09,193 [INFO] Model/checkpoints will be saved to: ./checkpoints/GIN_0.001_ENZYMES
2025-06-16 15:05:09,194 [INFO] 开始创建数据加载器...
2025-06-16 15:05:09,203 [INFO] Successfully loaded dataset ENZYMES from ./data, total graphs: 600
2025-06-16 15:05:09,219 [INFO] Source classes: [0, 1, 2, 3]
2025-06-16 15:05:09,219 [INFO] Source label mapping: {0: 0, 1: 1, 2: 2, 3: 3}
2025-06-16 15:05:09,219 [INFO] Source data split - Train: 320, Val: 80
2025-06-16 15:05:09,220 [INFO] Source train label distribution: {3: 80, 1: 80, 0: 80, 2: 80}
2025-06-16 15:05:09,220 [INFO] Source val label distribution: {1: 20, 0: 20, 2: 20, 3: 20}
2025-06-16 15:05:09,221 [INFO] Successfully loaded dataset ENZYMES from ./data, total graphs: 600
2025-06-16 15:05:09,236 [INFO] Target classes: [0, 1, 2, 3, 4, 5]
2025-06-16 15:05:09,236 [INFO] Target label mapping: {0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 4}
2025-06-16 15:05:09,236 [INFO] Unknown label index: 4
2025-06-16 15:05:09,236 [INFO] Target data split - Train: 480, Val: 120
2025-06-16 15:05:09,236 [INFO] Target total count: 600 (known: 400, unknown: 200)
2025-06-16 15:05:09,236 [INFO] Target total label distribution: {4: 200, 0: 100, 1: 100, 2: 100, 3: 100}
2025-06-16 15:05:09,236 [INFO] Target train label distribution: {3: 80, 4: 160, 1: 80, 2: 80, 0: 80}
2025-06-16 15:05:09,236 [INFO] Target val label distribution: {1: 20, 3: 20, 2: 20, 0: 20, 4: 40}
2025-06-16 15:05:09,237 [INFO] 数据加载器创建完成!
2025-06-16 15:05:09,237 [INFO] 源域类别数: 4
2025-06-16 15:05:09,237 [INFO] 目标域类别数: 5 (包含未知类别)
2025-06-16 15:05:09,237 [INFO] Loaded source data - Train: 320, Val: 80
2025-06-16 15:05:09,237 [INFO] Model config - Features: 3, Classes: 4
2025-06-16 15:05:09,237 [INFO] Source label mapping: {0: 0, 1: 1, 2: 2, 3: 3}
2025-06-16 15:05:09,261 [INFO] Model initialized with 599300 parameters
2025-06-16 15:05:09,261 [INFO] Starting training...
2025-06-16 15:05:09,504 [INFO] Epoch 001 | Train Loss: 11.6658 | Val Loss: 1.5294 | Val Acc: 0.2375
2025-06-16 15:05:09,692 [INFO] New best model at epoch 1 (Val Acc: 0.2375)
2025-06-16 15:05:09,876 [INFO] Epoch 002 | Train Loss: 8.9696 | Val Loss: 2.1734 | Val Acc: 0.2500
2025-06-16 15:05:09,890 [INFO] New best model at epoch 2 (Val Acc: 0.2500)
2025-06-16 15:05:10,030 [INFO] Epoch 003 | Train Loss: 7.4818 | Val Loss: 2.4059 | Val Acc: 0.3250
2025-06-16 15:05:10,045 [INFO] New best model at epoch 3 (Val Acc: 0.3250)
2025-06-16 15:05:10,188 [INFO] Epoch 004 | Train Loss: 6.0922 | Val Loss: 3.2875 | Val Acc: 0.3250
2025-06-16 15:05:10,354 [INFO] Epoch 005 | Train Loss: 7.1087 | Val Loss: 4.1479 | Val Acc: 0.2750
2025-06-16 15:05:10,500 [INFO] Epoch 006 | Train Loss: 5.1410 | Val Loss: 4.4288 | Val Acc: 0.3625
2025-06-16 15:05:10,516 [INFO] New best model at epoch 6 (Val Acc: 0.3625)
2025-06-16 15:05:10,678 [INFO] Epoch 007 | Train Loss: 4.3490 | Val Loss: 2.9367 | Val Acc: 0.3875
2025-06-16 15:05:10,694 [INFO] New best model at epoch 7 (Val Acc: 0.3875)
2025-06-16 15:05:10,835 [INFO] Epoch 008 | Train Loss: 5.1296 | Val Loss: 3.2449 | Val Acc: 0.3250
2025-06-16 15:05:10,999 [INFO] Epoch 009 | Train Loss: 4.4721 | Val Loss: 2.5395 | Val Acc: 0.3375
2025-06-16 15:05:11,151 [INFO] Epoch 010 | Train Loss: 4.5620 | Val Loss: 2.4146 | Val Acc: 0.3250
2025-06-16 15:05:11,403 [INFO] Epoch 011 | Train Loss: 5.0252 | Val Loss: 2.2364 | Val Acc: 0.3750
2025-06-16 15:05:11,581 [INFO] Epoch 012 | Train Loss: 2.9421 | Val Loss: 1.6697 | Val Acc: 0.4500
2025-06-16 15:05:11,596 [INFO] New best model at epoch 12 (Val Acc: 0.4500)
2025-06-16 15:05:11,766 [INFO] Epoch 013 | Train Loss: 2.8579 | Val Loss: 1.7828 | Val Acc: 0.3375
2025-06-16 15:05:11,932 [INFO] Epoch 014 | Train Loss: 3.1402 | Val Loss: 1.7342 | Val Acc: 0.3875
2025-06-16 15:05:12,092 [INFO] Epoch 015 | Train Loss: 3.4243 | Val Loss: 1.5870 | Val Acc: 0.4125
2025-06-16 15:05:12,262 [INFO] Epoch 016 | Train Loss: 2.2608 | Val Loss: 1.6183 | Val Acc: 0.3125
2025-06-16 15:05:12,423 [INFO] Epoch 017 | Train Loss: 2.9300 | Val Loss: 2.2300 | Val Acc: 0.3000
2025-06-16 15:05:12,587 [INFO] Epoch 018 | Train Loss: 2.0897 | Val Loss: 2.3158 | Val Acc: 0.2875
2025-06-16 15:05:12,732 [INFO] Epoch 019 | Train Loss: 2.4601 | Val Loss: 1.7299 | Val Acc: 0.3250
2025-06-16 15:05:12,877 [INFO] Epoch 020 | Train Loss: 2.1547 | Val Loss: 1.7078 | Val Acc: 0.2750
2025-06-16 15:05:13,121 [INFO] Epoch 021 | Train Loss: 2.9909 | Val Loss: 2.1259 | Val Acc: 0.2625
2025-06-16 15:05:13,263 [INFO] Epoch 022 | Train Loss: 2.4368 | Val Loss: 1.3451 | Val Acc: 0.3625
2025-06-16 15:05:13,429 [INFO] Epoch 023 | Train Loss: 3.1509 | Val Loss: 1.5059 | Val Acc: 0.4250
2025-06-16 15:05:13,585 [INFO] Epoch 024 | Train Loss: 2.5930 | Val Loss: 2.1037 | Val Acc: 0.2875
2025-06-16 15:05:13,729 [INFO] Epoch 025 | Train Loss: 2.6574 | Val Loss: 1.7497 | Val Acc: 0.3125
2025-06-16 15:05:13,899 [INFO] Epoch 026 | Train Loss: 1.7300 | Val Loss: 2.0844 | Val Acc: 0.3125
2025-06-16 15:05:14,065 [INFO] Epoch 027 | Train Loss: 2.7806 | Val Loss: 1.7867 | Val Acc: 0.4000
2025-06-16 15:05:14,076 [INFO] Early stopping at epoch 27 (no improvement in 15 epochs).
2025-06-16 15:05:14,087 [INFO] Best model saved to ./checkpoints/GIN_0.001_ENZYMES/best_source_gin.pth (Val Acc: 0.4500 at epoch 12)
2025-06-16 15:05:14,088 [INFO] Training/validation metrics saved to ./checkpoints/GIN_0.001_ENZYMES/train_metrics.csv
2025-06-16 15:05:14,164 [INFO] Final training curves saved
2025-06-16 15:05:14,164 [INFO] Training completed!
2025-06-16 15:05:14,164 [INFO] Best validation accuracy: 0.4500 at epoch 12
2025-06-16 15:05:14,164 [INFO] Total epochs trained: 27
